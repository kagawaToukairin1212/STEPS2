<div class="container">
    <!-- ã‚·ãƒ¼ãƒˆã‚¿ã‚¤ãƒˆãƒ« -->
    <h2 class="fw-bold text-center"><%= @sheet.title %></h2>

    <!-- æ£’ã‚°ãƒ©ãƒ• -->
    <div class="row">
        <div class="col-12">
            <canvas id="barChart" data-controller="bar-chart"
                data-bar-chart-scores="<%= @scores.to_json %>"
                data-bar-chart-labels="<%= @labels.to_json %>"
                data-bar-chart-colors="<%= @colors.to_json %>"
                width="700" height="500"> <!-- ğŸŸ¢ ç¸¦ã‚’é•·ãã™ã‚‹ -->
            </canvas>
        </div>
    </div>

    <!-- <%= debug @scores %> -->

    <!-- ãƒ¬ãƒ¼ãƒ€ãƒ¼ã‚°ãƒ©ãƒ•ã¨ç›®æ¨™ã®è¡¨ç¤º -->
    <div class="row mt-4">
        <!-- ãƒ¬ãƒ¼ãƒ€ãƒ¼ã‚°ãƒ©ãƒ• -->
        <div class="col-md-6">
            <canvas id="radarChart" data-controller="radar-graph"
                data-radar-graph-scores="<%= @scores.to_json %>"
                data-radar-graph-labels="<%= @labels.to_json %>"
                data-radar-graph-colors="<%= @colors.to_json %>"
                width="500" height="500"> <!-- ğŸŸ¢ ã‚µã‚¤ã‚ºã‚’å¤§ããã™ã‚‹ -->
            </canvas>
        </div>

        <!-- ç›®æ¨™ãƒªã‚¹ãƒˆ -->
        <div class="col-md-6">
            <h3 class="fw-bold text-center">ç›®æ¨™</h3>
            <% @sheet.goals.each do |goal| %>
                <p><strong><%= goal.evaluation_department.name %>:</strong> <%= goal.value %></p>
            <% end %>
        </div>
    </div>



<div class="container mt-5">
    <h3 class="fw-bold text-center">è©•ä¾¡çµæœ</h3>
    <div class="table-responsive">
        <table class="table table-bordered table-striped table-hover">
            <thead class="table-light">
                <tr>
                    <th class="sticky-top bg-white">ç›®æ¨™</th>
                    <% @scores_by_date.keys.each do |date| %>
                        <th class="sticky-top bg-white">
                            <%= DateTime.parse(date).strftime("%m/%d %H:%M") %>
                            <%= link_to "ç·¨é›†", edit_by_date_sheet_evaluation_scores_path(@sheet, date: date), class: "btn btn-sm btn-outline-primary ms-2" %>
                        </th>
                    <% end %>
                </tr>
            </thead>
            <tbody>
                <% @evaluation_results.each do |result| %>
                    <tr>
                        <td><%= result[:name] %></td>
                        <% @scores_by_date.keys.each do |date| %>
                            <% score = @sheet.goals.flat_map(&:evaluation_scores).find { |s| s.created_at.strftime("%Y/%m/%d %H:%M:%S") == date && s.goal.evaluation_department.name == result[:name] } %>
                            <td>
                                <%= score ? score.result : "-" %>
                            </td>
                        <% end %>
                    </tr>
                <% end %>
            </tbody>
        </table>
    </div>
</div>



  <%= link_to "ç›®æ¨™ã‚’å¤‰æ›´ã™ã‚‹", edit_goals_sheet_path(@sheet), class: "btn btn-warning mt-3" %>
  <%= button_to "ã‚·ãƒ¼ãƒˆã‚’å‰Šé™¤ã™ã‚‹", sheet_path(@sheet),
    method: :delete,
    data: {
      turbo: false,  # â† âœ… ã“ã“ãŒãƒã‚¤ãƒ³ãƒˆ
      confirm: "æœ¬å½“ã«ã“ã®ã‚·ãƒ¼ãƒˆã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ"
    },
    class: "btn btn-danger mt-3 ms-2" %>



</div>